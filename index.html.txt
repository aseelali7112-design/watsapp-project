<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙˆØ§ØªØ³Ø§Ø¨ ÙŠÙ…Ù†ÙŠ Ù…ØªÙ‚Ø¯Ù…</title>
<link rel="stylesheet" href="B.css"> <!-- Ø±Ø¨Ø· Ù…Ù„Ù CSS Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ -->
</head>
<body>

<div class="container">
  <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
  <div class="sidebar">
    <!-- Ø±Ø£Ø³ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ù…Ø¹ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
    <div class="header">
      <img src="c:\Users\M.D\Desktop\Ø§Ù„ÙŠÙ…Ù†.jpg" alt="ØµÙˆØ±Ø© Ø´Ø®ØµÙŠØ©" class="profile-img">
      <h2>ÙˆØ§ØªØ³Ø§Ø¨ ÙŠÙ…Ù†ÙŠ</h2>
    </div>

    <!-- Ù‚Ø³Ù… Ø§Ù„Ø­Ø§Ù„Ø§Øª -->
    <div class="status-section">
      <h3>Ø§Ù„Ø­Ø§Ù„Ø§Øª</h3>
      <button id="add-status-btn">â• Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø©</button> <!-- Ø²Ø± ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø§Ù„Ø© -->
      <div class="status-list" id="status-list"></div> <!-- Ù‚Ø§Ø¦Ù…Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø§Øª -->
    </div>

    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª -->
    <div class="chat-list">
      <div class="chat-item active" data-user="ahmed">
        <img src="c:\Users\M.D\Desktop\IMG (2).jpg" alt="Ø§ØµÙŠÙ„">
        <span>Ø§ØµÙŠÙ„ Ø§Ù„Ø¹ÙŠØ§Ø´ÙŠ<br>+967712345678</span>
      </div>
      
      <div class="chat-item" data-user="fatima">
        <img src="img.jpg" alt="Ø±ÙŠØ§Ø¶ ØµØ§Ù„Ø­">
        <span>Ø±ÙŠØ§Ø¶ ØµØ§Ù„Ø­<br>+967712345679</span>
      </div>
      <div class="chat-item" data-user="mohamed">
        <img src="c:\Users\M.D\Pictures\Ø´Ø¨Ø§Ø¨ Ø³ØªØ§ÙŠÙ„.jpg" alt="ÙƒÙ‡Ù„Ø§Ù†">
        <span>ÙƒÙ‡Ù„Ø§Ù† Ø§Ù„Ø§ÙƒÙˆØ¹<br>+967712345680</span>
      </div>
      
    </div>
    
  </div>

  <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© -->
  <div class="chat-area">
    <!-- Ø±Ø£Ø³ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© -->
    <div class="chat-header">
      <img src="ahmed.jpg" alt="ØµÙˆØ±Ø©">
      <h3 id="chat-user">Ø§ØµÙŠÙ„ Ø§Ù„Ø¹ÙŠØ§Ø´ÙŠ</h3>
    </div>

    <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
    <div class="messages" id="messages"></div>

    <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
    <div class="message-input">
      <input type="file" id="file-input" accept="image/*,video/*,.pdf,.doc,.docx" style="display:none;">
      <button id="attach-btn">ğŸ“</button> <!-- Ø²Ø± Ø±ÙØ¹ Ù…Ù„ÙØ§Øª -->
      <input type="text" id="message-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ù‡Ù†Ø§...">
      <button id="mic-btn">ğŸ¤</button> <!-- Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª -->
      <button id="send-btn">â¤</button> <!-- Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ -->
    </div>
  </div>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø§Ù„Ø© -->
<div id="status-modal" class="status-modal">
  <div class="status-modal-content">
    <span class="close" id="close-status-modal">&times;</span> <!-- Ø²Ø± Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© -->
    <h3>Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø©</h3>
    <select id="status-user-select">
      <option value="ahmed">Ø§ØµÙŠÙ„</option>
      <option value="fatima">Ø±ÙŠØ§Ø¶</option>
      <option value="mohamed">ÙƒÙ‡Ù„Ø§Ù†</option>
    </select>
    <input type="file" id="status-file-input" accept="image/*,video/*"> <!-- Ø±ÙØ¹ ØµÙˆØ±Ø© Ø£Ùˆ ÙÙŠØ¯ÙŠÙˆ Ù„Ù„Ø­Ø§Ù„Ø© -->
    <button id="save-status-btn">Ø¥Ø¶Ø§ÙØ©</button>
  </div>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø© -->
<div id="status-viewer-modal" class="status-viewer">
  <span class="close" id="close-status-viewer">&times;</span> <!-- Ø²Ø± Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø±Ø¶ -->
  <button id="prev-status">&#10094;</button> <!-- Ø²Ø± Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© -->
  <div id="status-viewer-content"></div> <!-- Ù‡Ù†Ø§ ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø£Ùˆ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ -->
  <button id="next-status">&#10095;</button> <!-- Ø²Ø± Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© -->
  <div id="status-viewer-user"></div> <!-- Ø¥Ø¸Ù‡Ø§Ø± Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª -->
</div>

<script>
// -------------------- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª --------------------
const chats = { ahmed: [], fatima: [], mohamed: [] }; // Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù…
const userData = { 
  ahmed:{name:"Ø§ØµÙŠÙ„",img:"ahmed.jpg"}, 
  fatima:{name:"Ø±ÙŠØ§Ø¶",img:"fatima.jpg"}, 
  mohamed:{name:"ÙƒÙ‡Ù„Ø§Ù†",img:"mohamed.jpg"} 
};
let currentUser='ahmed'; // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©

const messagesEl=document.getElementById('messages');
const inputEl=document.getElementById('message-input');
const sendBtn=document.getElementById('send-btn');
const chatItems=document.querySelectorAll('.chat-item');
const chatUserEl=document.getElementById('chat-user');
const chatHeaderImg=document.querySelector('.chat-header img');

// ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø´Ø®Øµ
chatItems.forEach(item=>{
  item.addEventListener('click',()=>{
    chatItems.forEach(i=>i.classList.remove('active'));
    item.classList.add('active');
    currentUser=item.dataset.user;
    chatUserEl.textContent=item.querySelector('span').textContent.split('\n')[0];
    chatHeaderImg.src=item.querySelector('img').src;
    renderMessages();
  });
});

// Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
function renderMessages(){
  messagesEl.innerHTML='';
  chats[currentUser].forEach(msg=>{
    const div=document.createElement('div');
    div.classList.add('message', msg.type);
    div.innerHTML=`<span class="message-user">${msg.user}</span>${msg.text}<span class="message-time">${msg.time}</span>`;
    messagesEl.appendChild(div);
  });
  messagesEl.scrollTop=messagesEl.scrollHeight;
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ
function getCurrentTime(){
  const now=new Date();
  return `${now.getHours()}:${now.getMinutes().toString().padStart(2,'0')}`;
}

// Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ©
function sendMessage(){
  const text=inputEl.value.trim();
  if(!text) return;
  const time=getCurrentTime();
  chats[currentUser].push({text,type:'sent',user:'Ø£Ù†Øª',time});
  Object.keys(chats).forEach(user=>{
    if(user!==currentUser) chats[user].push({text,type:'received',user:userData[currentUser].name,time});
  });
  inputEl.value='';
  renderMessages();
}

sendBtn.addEventListener('click',sendMessage);
inputEl.addEventListener('keypress',e=>{if(e.key==='Enter') sendMessage();});

// -------------------- Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª --------------------
const fileInput=document.getElementById('file-input');
const attachBtn=document.getElementById('attach-btn');
attachBtn.addEventListener('click',()=>fileInput.click());
fileInput.addEventListener('change',()=>{
  const file=fileInput.files[0];
  if(!file) return;
  const time=getCurrentTime();
  let content='';
  if(file.type.startsWith('image/')) content=`<img src="${URL.createObjectURL(file)}" style="max-width:200px;border-radius:10px;">`;
  else if(file.type.startsWith('video/')) content=`<video controls style="max-width:200px;border-radius:10px;"><source src="${URL.createObjectURL(file)}" type="${file.type}"></video>`;
  else content=`<a href="${URL.createObjectURL(file)}" target="_blank">${file.name}</a>`;
  chats[currentUser].push({text:content,type:'sent',user:'Ø£Ù†Øª',time});
  Object.keys(chats).forEach(user=>{
    if(user!==currentUser) chats[user].push({text:content,type:'received',user:userData[currentUser].name,time});
  });
  renderMessages();
  fileInput.value='';
});

// -------------------- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª Ù…Ø¹ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ --------------------
const micBtn=document.getElementById('mic-btn');
let mediaRecorder,audioChunks=[];

micBtn.addEventListener('click',async()=>{
  if(!mediaRecorder || mediaRecorder.state==='inactive'){
    const stream=await navigator.mediaDevices.getUserMedia({audio:true});
    mediaRecorder=new MediaRecorder(stream);
    audioChunks=[];
    
    mediaRecorder.ondataavailable=e=>audioChunks.push(e.data);

    mediaRecorder.onstop=()=>{
      const audioBlob=new Blob(audioChunks,{type:'audio/webm'});
      const audioUrl=URL.createObjectURL(audioBlob);
      const time=getCurrentTime();
      const content=`<audio controls src="${audioUrl}"></audio>`;

      // Ø¥Ø¶Ø§ÙØ© Ù„Ù„ØµØ¯ÙŠÙ‚ Ø§Ù„Ø­Ø§Ù„ÙŠ
      chats[currentUser].push({text:content,type:'sent',user:'Ø£Ù†Øª',time});

      // Ø¥Ø±Ø³Ø§Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†
      Object.keys(chats).forEach(user=>{
        if(user!==currentUser){
          chats[user].push({text:content,type:'received',user:userData[currentUser].name,time});
        }
      });

      renderMessages();
    };

    mediaRecorder.start();
    micBtn.textContent='â¹ï¸'; // Ø²Ø± Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù
  } else {
    mediaRecorder.stop();
    micBtn.textContent='ğŸ¤'; // Ø²Ø± Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  }
});

// -------------------- Ø§Ù„Ø­Ø§Ù„Ø§Øª --------------------
const statusListEl=document.getElementById('status-list');
const statusModal=document.getElementById('status-modal');
const addStatusBtn=document.getElementById('add-status-btn');
const closeStatusModal=document.getElementById('close-status-modal');
const saveStatusBtn=document.getElementById('save-status-btn');
const statusFileInput=document.getElementById('status-file-input');
const statusUserSelect=document.getElementById('status-user-select');
const statusViewerModal=document.getElementById('status-viewer-modal');
const statusViewerContent=document.getElementById('status-viewer-content');
const statusViewerUser=document.getElementById('status-viewer-user');
const closeStatusViewer=document.getElementById('close-status-viewer');
const nextStatusBtn=document.getElementById('next-status');
const prevStatusBtn=document.getElementById('prev-status');

let statuses=[];
let currentStatusIndex=0;

// ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø§Ù„Ø©
addStatusBtn.addEventListener('click',()=>statusModal.style.display='flex');
closeStatusModal.addEventListener('click',()=>statusModal.style.display='none');

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ø¹Ø¯ Ø±ÙØ¹Ù‡Ø§
saveStatusBtn.addEventListener('click',()=>{
  const file=statusFileInput.files[0];
  if(!file) return alert('Ø§Ø®ØªØ± Ù…Ù„Ù Ø£ÙˆÙ„Ø§Ù‹');
  const user=statusUserSelect.value;
  const reader=new FileReader();
  reader.onload=e=>{
    const type=file.type.startsWith('image/')?'image':'video';
    const statusObj={user,src:e.target.result,type,views:0};
    statuses.push(statusObj);
    renderStatuses();
    statusModal.style.display='none';
    statusFileInput.value='';
  };
  reader.readAsDataURL(file);
});

// Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø§Øª ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
function renderStatuses(){
  statusListEl.innerHTML='';
  statuses.forEach((s,i)=>{
    const div=document.createElement('div');
    div.classList.add('status-item');
    div.dataset.user=s.user;
    div.dataset.index=i;
    div.innerHTML=s.type==='image'?
      `<img src="${s.src}" alt="${s.user}"><span>${userData[s.user].name}</span>`:
      `<video src="${s.src}" style="width:55px;height:55px;border-radius:50%;"></video><span>${userData[s.user].name}</span>`;
    div.addEventListener('click',()=>showStatusViewer(i));
    statusListEl.appendChild(div);
  });
}

// Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ù†Ø§ÙØ°Ø© Ø£ÙƒØ¨Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡Ø§
function showStatusViewer(index){
  currentStatusIndex=index;
  const s=statuses[index];
  if(!s) return;
  s.views+=1;
  // ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ Ù„ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± ÙˆÙˆØ§Ø¶Ø­
  statusViewerContent.innerHTML = s.type==='image' ?
    `<img src="${s.src}" alt="${s.user}" style="max-width:80%;max-height:80%;">` :
    `<video src="${s.src}" autoplay controls style="max-width:80%;max-height:80%;"></video>`;
  statusViewerUser.textContent=`${userData[s.user].name} - ${s.views} Ù…Ø´Ø§Ù‡Ø¯Ø©`;
  statusViewerModal.style.display='flex';
}

// Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø©
closeStatusViewer.addEventListener('click',()=>statusViewerModal.style.display='none');

// Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø£Ùˆ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
nextStatusBtn.addEventListener('click',()=>showStatusViewer((currentStatusIndex+1)%statuses.length));
prevStatusBtn.addEventListener('click',()=>showStatusViewer((currentStatusIndex-1+statuses.length)%statuses.length));

// Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ø²Ø± ESC
document.addEventListener('keydown',(e)=>{
  if(e.key==='Escape'){
    statusViewerModal.style.display='none';
  }
});
</script>

</body>
</html>


